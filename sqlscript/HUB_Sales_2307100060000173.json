{
	"name": "HUB_Sales_2307100060000173",
	"properties": {
		"content": {
			"query": "select * from [HUB_Sales_Actual] order by hk_sales asc\nselect  * from dbo.hub_sales order by hk_sales asc\n\n\n\n select a.hk_sales\n     , b.hk_sales\n     , case when a.hk_sales = b.hk_sales then 1 else 0 end  \n\t , DIFFERENCE(a.hk_sales, b.hk_sales) diff\n\t , ASCII(a.hk_sales) ascii_a\n\t , ASCII(b.hk_sales) ascii_b\n      from dbo.HUB_Sales  a  \ninner join  dbo.HUB_Sales_Actual  b\non a.hk_sales = upper(b.hk_sales)\n\n select a.hk_sales\n     , b.hk_sales\n    --  , case when a.hk_sales = b.hk_sales then 1 else 0 end  \n\t--  , DIFFERENCE(a.hk_sales, b.hk_sales)\n\t--  , ASCII(a.hk_sales) ascii_a\n\t--  , ASCII(b.hk_sales) ascii_b\n      from dbo.HUB_Sales  a  \ninner join  dbo.HUB_Sales_Actual  b\non a.hk_sales = b.hk_sales\n\n select a.hk_sales\n     , b.hk_sales\n\t , a.bk_sales\n\t , b.bk_sales\n    --  , case when a.hk_sales = b.hk_sales then 1 else 0 end  \n\t--  , DIFFERENCE(a.hk_sales, b.hk_sales)\n\t--  , ASCII(a.hk_sales) ascii_a\n\t--  , ASCII(b.hk_sales) ascii_b\n      from dbo.HUB_Sales  a  \ninner join  dbo.HUB_Sales_Actual  b\non a.bk_sales = b.bk_sales\n\n\nselect ASCII('A'), ASCII('a'),ASCII(N'32DA800C028221EF7CA747360C9B7FD1'), ASCII(N'32da800c028221ef7ca747360c9b7fd1')\n\ndeclare @aval nvarchar(32), @bval nvarchar(32)\nselect top 1  @aval=HK_Sales from [HUB_Sales_Actual] order by hk_sales asc\nselect  top 1  @bval=HK_Sales from dbo.hub_sales order by hk_sales asc\n\nselect @bval,* from [HUB_Sales_Actual] where HK_Sales=@bval\nselect @aval,* from hub_sales where HK_Sales=@aval\n\n\n---DDL---\n\nIF OBJECT_ID(N'[dbo].[HUB_Sales]', N'U') IS NOT NULL  \n   DROP TABLE [dbo].[HUB_Sales];  \nGO\n\nCREATE TABLE [dbo].[HUB_Sales] with ( clustered index(HK_Sales)  , distribution = hash(HK_Sales))  AS\n--  select convert(nvarchar(32), HASHBYTES('MD5', CONCAT( 'Actual', '^' ,TRIM(PALEDGER), '^',TRIM(VRGAR), '^',TRIM(VERSI), '^',TRIM(PERIO), '^',TRIM(PAOBJNR), '^',TRIM(PASUBNR), '^',TRIM(BELNR), '^',TRIM(POSNR))),2) AS HK_Sales\nselect convert(VARBINARY, HASHBYTES('MD5', CONCAT( 'Actual', '^' ,TRIM(PALEDGER), '^',TRIM(VRGAR), '^',TRIM(VERSI), '^',TRIM(PERIO), '^',TRIM(PAOBJNR), '^',TRIM(PASUBNR), '^',TRIM(BELNR), '^',TRIM(POSNR))),2) AS HK_Sales\n, CAST('Actual' AS VARCHAR(10))AS [Version]\n, [PALEDGER]  AS   [Currency_Type]\n, [VRGAR]  AS   [Record_Type]\n, [VERSI]  AS   [Plan_version_CO_PA]\n, [PERIO]  AS   [Period_Year]\n, [PAOBJNR]  AS   [Profitability_Segment_Number_CO_PA]\n, [PASUBNR]  AS   [Profitability_Segment_Changes_CO_PA]\n, [BELNR]  AS   [Profitability_Analysis_Chit_Number]\n, [POSNR]  AS   [CO_PA_Item_Number]\n, CONCAT( 'Actual', '^' ,TRIM(PALEDGER), '^',TRIM(VRGAR), '^',TRIM(VERSI), '^',TRIM(PERIO), '^',TRIM(PAOBJNR), '^',TRIM(PASUBNR), '^',TRIM(BELNR), '^',TRIM(POSNR))AS BK_Sales\n, DATEADD(HOUR, 9, GETDATE()) AS EDW_LOAD_DTS , 'CE1KR01' AS RECORD_SRC\n FROM [dbo].[CE1KR01_D]\n\n\n\nIF OBJECT_ID(N'[dbo].[HUB_Sales_Actual]', N'U') IS NOT NULL  \n   DROP TABLE [dbo].[HUB_Sales_Actual];  \nGO\n\n\nCREATE TABLE dbo.[HUB_Sales_Actual]\n(\n\t[HK_Sales] [nvarchar](32) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Version] [varchar](10) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Currency_Type] [nvarchar](2) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Record_Type] [nvarchar](1) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Plan_version_CO_PA] [nvarchar](3) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Period_Year] [nvarchar](7) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Profitability_Segment_Number_CO_PA] [nvarchar](10) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Profitability_Segment_Changes_CO_PA] [nvarchar](4) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Profitability_Analysis_Chit_Number] [nvarchar](10) COLLATE Korean_Wansung_CI_AS NULL,\n\t[CO_PA_Item_Number] [nvarchar](6) COLLATE Korean_Wansung_CI_AS NULL,\n\t[BK_Sales] [nvarchar](57) COLLATE Korean_Wansung_CI_AS NOT NULL,\n\t[EDW_LOAD_DTS] [nvarchar] NULL,\n\t[RECORD_SRC] [nvarchar](7) COLLATE Korean_Wansung_CI_AS  NULL\n)\nWITH\n(\n\tDISTRIBUTION = HASH ( [HK_Sales] ),\n\tCLUSTERED INDEX\n\t(\n\t\t[HK_Sales] ASC\n\t)\n)\nGO\n------------------2023/08/21---------------------\n\n\n\nCREATE TABLE dbo.[HUB_Sales_Actual_fix]\n(\n\t[HK_Sales] [nvarchar](32) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Version] [varchar](10) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Currency_Type] [nvarchar](2) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Record_Type] [nvarchar](1) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Plan_version_CO_PA] [nvarchar](3) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Period_Year] [nvarchar](7) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Profitability_Segment_Number_CO_PA] [nvarchar](10) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Profitability_Segment_Changes_CO_PA] [nvarchar](4) COLLATE Korean_Wansung_CI_AS NULL,\n\t[Profitability_Analysis_Chit_Number] [nvarchar](10) COLLATE Korean_Wansung_CI_AS NULL,\n\t[CO_PA_Item_Number] [nvarchar](6) COLLATE Korean_Wansung_CI_AS NULL,\n\t[BK_Sales] [nvarchar](57) COLLATE Korean_Wansung_CI_AS NOT NULL,\n\t[EDW_LOAD_DTS] [nvarchar] NULL,\n\t[RECORD_SRC] [nvarchar](7) COLLATE Korean_Wansung_CI_AS  NULL\n)\nWITH\n(\n\t-- DISTRIBUTION = HASH ( [HK_Sales] ),\n\tDISTRIBUTION = ROUND_ROBIN,\n\tCLUSTERED INDEX\n\t(\n\t\t[HK_Sales] ASC\n\t)\n)\nGO\n\n\n\n\nCREATE TABLE [dbo].[HUB_Sales_fix] with ( clustered index(HK_Sales)  , DISTRIBUTION = ROUND_ROBIN --distribution = hash(HK_Sales)\n)  AS \n select convert(nvarchar(32), HASHBYTES('MD5', CONCAT( 'Actual', '^' ,TRIM(PALEDGER), '^',TRIM(VRGAR), '^',TRIM(VERSI), '^',TRIM(PERIO), '^',TRIM(PAOBJNR), '^',TRIM(PASUBNR), '^',TRIM(BELNR), '^',TRIM(POSNR))),2) AS HK_Sales\n, CAST('Actual' AS VARCHAR(10))AS [Version]\n, [PALEDGER]  AS   [Currency_Type]\n, [VRGAR]  AS   [Record_Type]\n, [VERSI]  AS   [Plan_version_CO_PA]\n, [PERIO]  AS   [Period_Year]\n, [PAOBJNR]  AS   [Profitability_Segment_Number_CO_PA]\n, [PASUBNR]  AS   [Profitability_Segment_Changes_CO_PA]\n, [BELNR]  AS   [Profitability_Analysis_Chit_Number]\n, [POSNR]  AS   [CO_PA_Item_Number]\n, CONCAT( 'Actual', '^' ,TRIM(PALEDGER), '^',TRIM(VRGAR), '^',TRIM(VERSI), '^',TRIM(PERIO), '^',TRIM(PAOBJNR), '^',TRIM(PASUBNR), '^',TRIM(BELNR), '^',TRIM(POSNR))AS BK_Sales\n, DATEADD(HOUR, 9, GETDATE()) AS EDW_LOAD_DTS , 'CE1KR01' AS RECORD_SRC\n FROM [CE1KR01_D]\n\n\n\n select a.hk_sales\n     , b.hk_sales\n    --  , case when a.hk_sales = b.hk_sales then 1 else 0 end  \n\t--  , DIFFERENCE(a.hk_sales, b.hk_sales)\n\t--  , ASCII(a.hk_sales) ascii_a\n\t--  , ASCII(b.hk_sales) ascii_b\n      from dbo.HUB_Sales_fix a  \ninner join  dbo.HUB_Sales_Actual_fix  b --test\non a.hk_sales = b.hk_sales\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "mjkor",
				"poolName": "mjkor"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}